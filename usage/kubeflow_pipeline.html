
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kubeflow pipeline &#8212; BTAP: ML  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Config" href="../api/config.html" />
    <link rel="prev" title="Re-run Model" href="model_run.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kubeflow-pipeline">
<h1>Kubeflow pipeline<a class="headerlink" href="#kubeflow-pipeline" title="Permalink to this headline">¶</a></h1>
<p>A kubeflow pipeline exists to run the training and modelling steps automatically. To run the pipleline the docker
image needs to be built.  Due to restrictions on which image registries are accepted on AAW, for this project images
were built on <a class="reference external" href="https://github.com/StatCan/aaw-contrib-containers">STATCAN AAW contrib</a>. Other platforms may allow
to build the docker image on any external registry.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>You will need to get the Docker image digest SHA or tag which is to be updated in the yaml files, everytime the
image is rebuilt and a new reference is created.</p></li>
<li><p>The source code and yaml for the pipleline is located in the pipeline folder.</p></li>
</ul>
</div>
<p>Check the arguements in the pipeline.py file are correct</p>
<ul class="simple">
<li><p>build_params: The minio location and filename the building simulation I/O file. This would be the path for the electric hourly file if it exist.</p></li>
<li><p>energy_hour: The minio location and filename for the hourly energy consumption file is located. This would be the path for the electric hourly file if it exist.</p></li>
<li><p>weather: The minio location and filename for the converted  weather file to be read.</p></li>
<li><p>build_params_val: The minio location and filename for the building simulation I/O file for the validation set, if it exist.</p></li>
<li><p>energy_hour_val: The minio location and filename for the hourly energy consumption file for the validation set, if it exist.</p></li>
<li><p>output_path: The minio location and filename where the output file should be written.</p></li>
<li><p>featureoutput_path:  The minio location and filename where the feature selection output file should be written.</p></li>
<li><p>featureestimator: The feature selection estimator type, default value is ‘lasso’</p></li>
<li><p>param_search: The values are ‘yes’ or ‘no’</p></li>
<li><p>build_params_gas: The minio location and filename the building simulation I/O file. This would be the path for the gas hourly file if it exist.</p></li>
<li><p>energy_hour_gas: The minio location and filename for the hourly energy consumption file is located. This would be the path for the gas hourly file if it exist.</p></li>
<li><p>predictoutput_path:  The minio location and filename where the predict output file should be written.</p></li>
</ul>
<p>After ensuring the paths specified in the pipeline.py is verifed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">py</span>
<span class="n">python3</span> <span class="n">upload</span><span class="o">-</span><span class="n">pipeline</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Monitor the pipeline run from <a class="reference external" href="https://kubeflow.aaw.cloud.statcan.ca/?ns=nrcan-btap">Recent Pipeline Runs on AAW</a>   and once completed successfullly, the respective output files will be stored on minio. Alternatively, click on <a class="reference external" href="https://kubeflow.aaw.cloud.statcan.ca/_/pipeline/#/experiments">BTAP ML</a> , then click on the desired run and check its log to monitor the pipeline run.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Ensure you are in nrcan-btap namespace when you check the links above.</p></li>
</ul>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">BTAP: ML</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html">Working on AAW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html#project-source-code">Project source code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrain.html">Train the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_run.html">Re-run Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Kubeflow pipeline</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/config.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/feature_selection.html">Feature selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/plot.html">Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/predict.html">Predict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/prepare_weather.html">Prepare weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/preprocessing.html">Preprocessing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="model_run.html" title="previous chapter">Re-run Model</a></li>
      <li>Next: <a href="../api/config.html" title="next chapter">Config</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Natural Resources Canada.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/kubeflow_pipeline.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>