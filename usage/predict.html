
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; BTAP: ML  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>The outputs from the preprocessing and feature selection steps are used as input to <code class="docutils literal notranslate"><span class="pre">predict.py</span></code>
to derive a trained model for predicting the energy and costing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">predict</span><span class="o">.</span><span class="n">py</span> <span class="n">input_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>This script will output the trained model as a .h5 file alongisde information on the training and testing
performed for analysis. The outputs from this step will be used when obtaining predictions with the model.</p>
<p>The parameters to the above script are documented at: <a class="reference internal" href="../api/predict.html#module-predict" title="predict"><code class="xref py py-mod docutils literal notranslate"><span class="pre">predict</span></code></a>.</p>
<p>The Machine Learning model which is used for training will vary depending on whether parameter tuning is or is not
performed (total outputs only) and depending on whether the user selects the more complex or simplistic model.
When hyperparameter tuning is used (total outputs only), the <a class="reference external" href="https://keras.io/api/keras_tuner/tuners/hyperband/">Keras Hyperband Tuner</a> is configured
to optimize the parameters based on the loss. The tuner also uses early stopping by monitoring the loss with a
patience of 5. Once the tuner finishes, the optimized model is built and used for training.</p>
<p>If hyperparameter tuning is not performed, a default model which has been evaluated as a baseline for performance is used.
There are two options for the default model, one with more hidden nodes and a lower learning rate and another with less hidden nodes and a larger learning rate.</p>
<ul class="simple">
<li><p>Larger model: This model uses a single layer of 10000 nodes with the ReLU activation function. An optional 10% dropout layer is then applied. The adam optimizer is used with a learning rate of 0.0001.</p></li>
<li><p>Smaller model: This model uses a single layer of 56 nodes with the ReLU activation function. An optional 10% dropout layer is then applied. The adam optimizer is used with a learning rate of 0.001.</p></li>
</ul>
<p>A customized RMSE loss function is defined and used for training which takes a sum of the labels and predictions before computing the RMSE loss.</p>
<p>The outputs will include breakdowns on the model’s overall performance and the model’s performance for each building type and climate zone.
When working with breakdowns of the energy and costing values, these breakdowns will be done for all types of costing and energy.</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">BTAP: ML</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html">Working on AAW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html#project-source-code">Project source code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrain.html">Train the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_model.html">Running a model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/config.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/feature_selection.html">Feature selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/predict.html">Predict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/prepare_weather.html">Prepare weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/run_model.html">Run Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/train_model_pipeline.html">Train Model Pipeline</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Natural Resources Canada.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/usage/predict.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>