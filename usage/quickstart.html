
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Quickstart &#8212; BTAP: ML  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Train the model" href="retrain.html" />
    <link rel="prev" title="Working on AAW" href="../aaw_setup.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this heading">¶</a></h1>
<p>If you just want to run all of the steps from training a model to using the model to obtain predictions, here are the steps to run. You may be able to skip some
of these depending on if the data has already been processed.</p>
<p>Each of the Python files can use an input configuration .yml file which contains all inputs to be used alongside descriptions of the inputs.
If used, the input file, which will be referenced as <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code>, will be passed when calling the training process (this file will be discussed below).
Each Python file can also use values passed to through command line arguements. All values except the config file are optional.
Thus, the config file must still be passed, but the CLI arguements will be given priority. A mix of command line and
config files can also be used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The scripts for the project are in the <code class="docutils literal notranslate"><span class="pre">src/</span></code> folder of the repository. All CLI parameters can be viewed
by calling the python file with <code class="docutils literal notranslate"><span class="pre">--help</span></code> arguement (Example: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train_model_pipeline.py</span> <span class="pre">--help</span></code>).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every file can be run independently, but the recommended steps are to run one of the two pipelines presented below.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Depending on the size of the input files, the amount of RAM needed can be exceedingly high. Thus, the inputs should be split
as needed if the RAM usage is too high.</p>
</div>
<section id="training-a-model">
<h2>Training a model<a class="headerlink" href="#training-a-model" title="Permalink to this heading">¶</a></h2>
<p>The first step to perform is to generate a trained Machine Learning model to later be used for obtaining predictions on energy values.
Obtaining a trained model can be performed by calling the <code class="docutils literal notranslate"><span class="pre">train_model_pipeline.py</span></code> file and passing the appropriate arguements.
Assuming that only the <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code> file is used and located inside of the current directory, the arguement to pass is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">train_model_pipeline</span><span class="o">.</span><span class="n">py</span> <span class="n">input_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>This will preprocess all input files and any corresponding weather files which need to be retrieved (outputting various preprocessed files),
perform feature selection (outputting a .json file), and train the model (outputting a .h5 trained model, two .pkl files, a .json file, and a .csv file).</p>
</section>
<section id="getting-model-predictions">
<h2>Getting model predictions<a class="headerlink" href="#getting-model-predictions" title="Permalink to this heading">¶</a></h2>
<p>With a trained Machine Learning model in the form of a .h5 file, the model will be used to obtain the predicted daily Megajoules per meter squared
and the predicted aggregated Gigajoules per meter squared (for a specified timeframe) for a batch of specified building files within a specified directory.
Obtaining the predictions from a model can be performed by calling the <code class="docutils literal notranslate"><span class="pre">run_model.py</span></code> file and passing the appropriate arguements.
Assuming that only the <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code> file is used and located inside of the current directory, the arguement to pass is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_model</span><span class="o">.</span><span class="n">py</span> <span class="n">input_config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>This will preprocess all input files and any corresponding weather files which need to be retrieved, and obtain predictions for all input data
(outputting two .csv files which contain the prediction outputs alongside identifiers for each building in the form building_file_name/building_index).</p>
</section>
<section id="input-configuration-file-input-config-yml">
<h2>Input configuration file (input_config.yml)<a class="headerlink" href="#input-configuration-file-input-config-yml" title="Permalink to this heading">¶</a></h2>
<p>When providing an input to one of the pipelines above, the command line arguements can be used or the input configuration can be used (or a combination of the two).
The template for the <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code> file can be found <a class="reference external" href="https://github.com/canmet-energy/btap_ml/blob/main/src/input_config.yml">here</a>.
Within this configuration file are different fields which are required for training and/or running. Each section is clearly labelled with
comments describing what the input is used for and which are mandatory. If not provided within this file, the appropriate input must be provided through
the CLI.</p>
<p>It is important to note that any input locations specified within this file or which are provided through the CLI are modified within the code.
Specifically, any input filename or directory provided as an input will have the Docker file’s input path appended to the beginning of the value if needed.
For example, if a file named electricity_building_params.xlsx is within the root folder which has been linked to the Docker’s input path
(/home/btap_ml/input), then when input to the input_config.yml file, only the value electricity_building_params.xlsx should be used in the
configuration file. When running outside of Docker, the input and output paths can be adjusted within the <code class="docutils literal notranslate"><span class="pre">config.py</span></code> file.</p>
<p>Similarly, when passing the <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code> file to the pipelines through the CLI, if the configuration file is at the root of the linked
input file from the Docker container, only <code class="docutils literal notranslate"><span class="pre">input_config.yml</span></code> will need to be passed as an arguement to the CLI. More information on
the Docker image is available <a class="reference external" href="https://hub.docker.com/r/juliantemp/btap_ml">on DockerHub</a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">BTAP: ML</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html">Working on AAW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aaw_setup.html#project-source-code">Project source code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#training-a-model">Training a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-model-predictions">Getting model predictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-configuration-file-input-config-yml">Input configuration file (input_config.yml)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="retrain.html">Train the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_model.html">Running a model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/config.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/feature_selection.html">Feature selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/plot.html">Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/predict.html">Predict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/prepare_weather.html">Prepare weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/run_model.html">Run Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/train_model_pipeline.html">Train Model Pipeline</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../aaw_setup.html" title="previous chapter">Working on AAW</a></li>
      <li>Next: <a href="retrain.html" title="next chapter">Train the model</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Natural Resources Canada.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.2.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/quickstart.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>